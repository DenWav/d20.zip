<!doctype html>
<!-- MIT license: https://d20.zip/license.txt -->
<!-- https://github.com/DenWav/d20.zip -->
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <title>d20.zip</title>
        <meta name="description" content="A simple 3D dice roller in your browser" />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://d20.zip" />
        <meta property="og:title" content="d20.zip - 3D Dice Roller" />
        <meta property="og:description" content="A simple 3D dice roller in your browser" />
        <meta property="og:image" content="https://d20.zip/assets/banner.png" />

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image" />
        <meta property="twitter:url" content="https://d20.zip" />
        <meta property="twitter:title" content="d20.zip - 3D Dice Roller" />
        <meta property="twitter:description" content="A simple 3D dice roller in your browser" />
        <meta property="twitter:image" content="https://d20.zip/assets/banner.png" />

        <link rel="icon" type="image/png" href="assets/favicon.png" />
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <canvas id="canvas"></canvas>
        <div id="webgl-error" style="display: none">
            <div style="font-size: 32px; font-weight: bold; margin-bottom: 20px">WebGL Error</div>
            <div>WebGL is not supported or disabled in your browser. This application requires WebGL to run.</div>
        </div>
        <div id="hamburger" onclick="window.toggleHistory()">☰</div>
        <div id="ui">
            <div id="error-message" style="display: none">Too many dice (limit: 256)</div>
            <div class="roll-container">
                <div class="dice-btn-group" style="grid-area: roll-1">
                    <button class="btn dice-btn-main" onclick="window.rollFormula('d2')">D2</button>
                    <div class="dice-btn-subs">
                        <div class="sub-btn adv" onclick="window.rollFormula('2d2kh1')">Adv</div>
                        <div class="sub-btn dis" onclick="window.rollFormula('2d2kl1')">Dis</div>
                    </div>
                </div>
                <div class="dice-btn-group" style="grid-area: roll-2">
                    <button class="btn dice-btn-main" onclick="window.rollFormula('d4')">D4</button>
                    <div class="dice-btn-subs">
                        <div class="sub-btn adv" onclick="window.rollFormula('2d4kh1')">Adv</div>
                        <div class="sub-btn dis" onclick="window.rollFormula('2d4kl1')">Dis</div>
                    </div>
                </div>
                <div class="dice-btn-group" style="grid-area: roll-3">
                    <button class="btn dice-btn-main" onclick="window.rollFormula('d6')">D6</button>
                    <div class="dice-btn-subs">
                        <div class="sub-btn adv" onclick="window.rollFormula('2d6kh1')">Adv</div>
                        <div class="sub-btn dis" onclick="window.rollFormula('2d6kl1')">Dis</div>
                    </div>
                </div>
                <div class="dice-btn-group" style="grid-area: roll-4">
                    <button class="btn dice-btn-main" onclick="window.rollFormula('d8')">D8</button>
                    <div class="dice-btn-subs">
                        <div class="sub-btn adv" onclick="window.rollFormula('2d8kh1')">Adv</div>
                        <div class="sub-btn dis" onclick="window.rollFormula('2d8kl1')">Dis</div>
                    </div>
                </div>
                <div class="dice-btn-group" style="grid-area: roll-5">
                    <button class="btn dice-btn-main" onclick="window.rollFormula('d10')">D10</button>
                    <div class="dice-btn-subs">
                        <div class="sub-btn adv" onclick="window.rollFormula('2d10kh1')">Adv</div>
                        <div class="sub-btn dis" onclick="window.rollFormula('2d10kl1')">Dis</div>
                    </div>
                </div>
                <div class="dice-btn-group" style="grid-area: roll-6">
                    <button class="btn dice-btn-main" onclick="window.rollFormula('d12')">D12</button>
                    <div class="dice-btn-subs">
                        <div class="sub-btn adv" onclick="window.rollFormula('2d12kh1')">Adv</div>
                        <div class="sub-btn dis" onclick="window.rollFormula('2d12kl1')">Dis</div>
                    </div>
                </div>
                <div class="dice-btn-group" style="grid-area: roll-7">
                    <button class="btn dice-btn-main" onclick="window.rollFormula('d20')">D20</button>
                    <div class="dice-btn-subs">
                        <div class="sub-btn adv" onclick="window.rollFormula('2d20kh1')">Adv</div>
                        <div class="sub-btn dis" onclick="window.rollFormula('2d20kl1')">Dis</div>
                    </div>
                </div>
                <div class="dice-btn-group" style="grid-area: roll-8">
                    <button class="btn dice-btn-main" onclick="window.rollFormula('d100')">D100</button>
                    <div class="dice-btn-subs">
                        <div class="sub-btn adv" onclick="window.rollFormula('2d100kh1')">Adv</div>
                        <div class="sub-btn dis" onclick="window.rollFormula('2d100kl1')">Dis</div>
                    </div>
                </div>
                <div id="formula-wrapper" style="grid-area: formula">
                    <label class="visually-hidden" for="formula">Roll formula</label>
                    <input type="text" id="formula" placeholder="e.g. 2d20 + d4" />
                    <button id="help-btn" onclick="window.toggleHelp()">?</button>
                </div>
                <div class="roll-control" style="grid-area: roll-control">
                    <button class="btn" onclick="window.rollFormula(document.getElementById('formula').value)">
                        Roll
                    </button>
                    <button
                        class="btn"
                        style="font-size: 12px"
                        onclick="window.clearAndRoll(document.getElementById('formula').value)"
                    >
                        Clear & Roll
                    </button>
                    <button class="btn btn-danger" onclick="window.clearDice()">Clear</button>
                </div>
            </div>
        </div>
        <div id="history">
            <div id="audio-controls">
                <label class="audio-toggle">
                    <input type="checkbox" id="audio-enabled" checked />
                    <span>Sound</span>
                </label>
                <label class="visually-hidden" for="audio-volume">Volume</label>
                <input type="range" id="audio-volume" min="0" max="100" value="40" />
                <span id="audio-volume-value">40%</span>
            </div>
            <div id="history-header-actions">
                <button id="clear-history-btn" onclick="window.clearHistory()">Clear History</button>
                <button id="reset-camera-btn" onclick="window.resetCamera()">Reset Camera</button>
            </div>
            <div id="history-list"></div>
        </div>
        <div
            id="latest-result-container"
            style="
                position: absolute;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                color: white;
                text-align: center;
                pointer-events: none;
                width: 100%;
            "
        >
            <div
                id="latest-result"
                style="font-size: 64px; font-weight: bold; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5)"
            ></div>
        </div>
        <a class="attribution" href="https://www.flaticon.com/free-icons/icosahedron" title="icosahedron icons"
            >Favicon created by Freepik - Flaticon</a
        >
        <a class="github-link" href="https://github.com/DenWav/d20.zip"
            ><img src="assets/github.svg" alt="GitHub Logo"
        /></a>
        <div id="help-modal" style="display: none" onclick="window.toggleHelp()">
            <div id="help-content">
                <div id="help-close" onclick="window.toggleHelp()">✕</div>
                <h3 style="margin-top: 0">Roll Formula Syntax</h3>
                <ul style="padding-left: 20px; text-align: left; margin-bottom: 0">
                    <li style="margin-bottom: 8px">
                        <strong><span style="color: #fb3232">N</span>d<span style="color: #efcc68">S</span></strong
                        >: Roll <span style="color: #fb3232">N</span> dice with
                        <span style="color: #efcc68">S</span> sides (e.g. <code>2d20</code>).
                    </li>
                    <li style="margin-bottom: 8px">
                        <strong
                            >kh<span style="color: #fb3232">N</span> / kl<span style="color: #fb3232">N</span></strong
                        >: Keep Highest or Lowest <span style="color: #fb3232">N</span> dice (e.g. <code>4d6kh3</code>).
                    </li>
                    <li style="margin-bottom: 8px">
                        <strong>ka</strong>: Keep Average of the dice (e.g. <code>10d10ka</code>).
                    </li>
                    <li style="margin-bottom: 8px">
                        <strong>min / max(a, b, ...)</strong>: Minimum or maximum of values.
                    </li>
                    <li style="margin-bottom: 8px"><strong>avg(a, b, ...)</strong>: Average of multiple values.</li>
                    <li style="margin-bottom: 8px">
                        <strong>* modifier</strong>: Expand dice group in functions (e.g. <code>max(*2d20, 10)</code>).
                    </li>
                    <li>
                        <strong>Math</strong>: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, and
                        <code>()</code>.
                    </li>
                </ul>
                <p>Example rolls:</p>
                <ul style="padding-left: 20px; text-align: left; margin-bottom: 0">
                    <li style="margin-bottom: 8px">
                        <code>2d20kh1</code> or <code>max(2d20)</code>: roll 2d20s with advantage
                    </li>
                    <li style="margin-bottom: 8px">
                        <code>2d20kl1</code> or <code>min(2d20)</code>: roll 2d20s with disadvantage
                    </li>
                    <li style="margin-bottom: 8px">
                        <code>max(*2d20, 10)</code>: roll 2d20s with advantage, with a minimum value of 10
                    </li>
                    <li style="margin-bottom: 8px">
                        <code>max(2d20, 10)</code>: roll 2d20s added together, with a minimum value of 10
                    </li>
                    <li style="margin-bottom: 8px">
                        <code>max(*2d20, *4d12)</code>: roll 2d20s and 4d12s all together, take the highest of all of
                        them
                    </li>
                    <li style="margin-bottom: 8px">
                        <code>max(*2d20, 4d12)</code>: roll 2d20s and 4d12s, take the highest of either d20 individually
                        or the 4d12s combined
                    </li>
                    <li style="margin-bottom: 8px">
                        <code>(6d6 * d4) + 8</code>: roll 6d6s and multiply that value by a d4, and add 8 to the result
                    </li>
                    <li style="margin-bottom: 8px"><code>3d6 / 2</code>: roll 3d6s and divide the result by 2</li>
                </ul>
            </div>
        </div>
        <script type="module" src="index.js"></script>
    </body>
</html>
